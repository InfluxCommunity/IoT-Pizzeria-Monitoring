[agent]
  interval = "2s"
  flush_interval = "2s"
  hostname = "pizzeria-telegraf"
  debug = false
  quiet = false

[[inputs.kafka_consumer]]
  brokers = ["${KAFKA_BOOTSTRAP_SERVERS}"]
  topics = ["${KAFKA_TOPIC}"]
  consumer_group = "pizzeria_telegraf"
  data_format = "json"
  
  # Parse JSON and extract measurement name
  json_name_key = "measurement"
  
  # Define which fields should be treated as tags (dimensions)
  tag_keys = [
    "equipment_id",
    "equipment_type", 
    "location",
    "event_type",
    "pizza_type",
    "order_id",
    "status",
    "size"
  ]
  
  # All other fields become metric values
  json_string_fields = []
  
[[outputs.influxdb_v2]]
  urls = ["http://${INFLUXDB_HOST}:8181"]
  token = "${INFLUXDB_TOKEN}"
  organization = "${INFLUXDB_ORG}"
  bucket = "${INFLUXDB_BUCKET}"
  
  # Timeout settings
  timeout = "5s"
  
  # Precision for timestamps
  precision = "s"
  
  # Debug output (disable in production)
  # debug = true